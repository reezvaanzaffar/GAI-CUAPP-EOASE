"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/session/route";
exports.ids = ["app/api/auth/session/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "./action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "./request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "./static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fsession%2Froute&page=%2Fapi%2Fauth%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fsession%2Froute.ts&appDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fsession%2Froute&page=%2Fapi%2Fauth%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fsession%2Froute.ts&appDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_ecommerce_outset_amazon_seller_ecosystem_7_app_api_auth_session_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/session/route.ts */ \"(rsc)/./app/api/auth/session/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/session/route\",\n        pathname: \"/api/auth/session\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/session/route\"\n    },\n    resolvedPagePath: \"E:\\\\ecommerce-outset---amazon-seller-ecosystem (7)\\\\app\\\\api\\\\auth\\\\session\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_ecommerce_outset_amazon_seller_ecosystem_7_app_api_auth_session_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/session/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGc2Vzc2lvbiUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYXV0aCUyRnNlc3Npb24lMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhdXRoJTJGc2Vzc2lvbiUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDZWNvbW1lcmNlLW91dHNldC0tLWFtYXpvbi1zZWxsZXItZWNvc3lzdGVtJTIwKDcpJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1FJTNBJTVDZWNvbW1lcmNlLW91dHNldC0tLWFtYXpvbi1zZWxsZXItZWNvc3lzdGVtJTIwKDcpJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUM7QUFDbEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lY29tbWVyY2Utb3V0c2V0Lz8wYjA5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkU6XFxcXGVjb21tZXJjZS1vdXRzZXQtLS1hbWF6b24tc2VsbGVyLWVjb3N5c3RlbSAoNylcXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXHNlc3Npb25cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwic3RhbmRhbG9uZVwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL3Nlc3Npb24vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL3Nlc3Npb25cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvc2Vzc2lvbi9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkU6XFxcXGVjb21tZXJjZS1vdXRzZXQtLS1hbWF6b24tc2VsbGVyLWVjb3N5c3RlbSAoNylcXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXHNlc3Npb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2F1dGgvc2Vzc2lvbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fsession%2Froute&page=%2Fapi%2Fauth%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fsession%2Froute.ts&appDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/session/route.ts":
/*!***************************************!*\
  !*** ./app/api/auth/session/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   clearAndRegenerateTokensRoute: () => (/* binding */ clearAndRegenerateTokensRoute),\n/* harmony export */   regenerateToken: () => (/* binding */ regenerateToken),\n/* harmony export */   testEndpoint: () => (/* binding */ testEndpoint)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_authOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/authOptions */ \"(rsc)/./lib/authOptions.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next-auth/jwt */ \"(rsc)/./node_modules/next-auth/jwt/index.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_1__.PrismaClient();\nasync function GET(request) {\n    try {\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_5__.getToken)({\n            req: request,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        if (!token) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No session found\"\n            }, {\n                status: 401\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            user: {\n                id: token.sub,\n                role: token.role\n            }\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Error in /api/auth/session:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to check session\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function testEndpoint() {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_2__.getServerSession)(_lib_authOptions__WEBPACK_IMPORTED_MODULE_3__.authOptions);\n        console.log(\"Test endpoint - Session retrieved by getServerSession:\", session);\n        return session ? {\n            status: 200,\n            body: session\n        } : {\n            status: 401,\n            body: {\n                error: \"No session found\"\n            }\n        };\n    } catch (error) {\n        console.error(\"Test endpoint - Error in getServerSession:\", error);\n        return {\n            status: 500,\n            body: {\n                error: \"Internal server error\"\n            }\n        };\n    }\n}\nasync function POST() {\n    try {\n        console.log(\"Clearing existing session tokens...\");\n        await prisma.session.deleteMany();\n        console.log(\"All session tokens cleared.\");\n        // Example user for testing\n        const user = {\n            id: \"1\",\n            role: \"ADMIN\"\n        };\n        const token = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_4__.createToken)(user);\n        console.log(\"New token generated:\", token);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Session tokens cleared and new token generated.\",\n            token\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Error clearing and regenerating tokens:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to clear and regenerate tokens\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function regenerateToken() {\n    try {\n        console.log(\"Regenerating session tokens for testing...\");\n        // Example user for testing\n        const user = {\n            id: \"1\",\n            role: \"ADMIN\"\n        };\n        const token = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_4__.createToken)(user);\n        console.log(\"New token generated:\", token);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"New token generated.\",\n            token\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Error regenerating tokens:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to regenerate tokens\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function clearAndRegenerateTokensRoute() {\n    try {\n        const token = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_4__.clearAndRegenerateTokens)();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Session tokens cleared and new token generated.\",\n            token\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Error clearing and regenerating tokens:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to clear and regenerate tokens\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZUFBZWM7SUFDcEIsSUFBSTtRQUNGLE1BQU10QixRQUFRLE1BQU1MLG1FQUF3QkE7UUFDNUMsT0FBT0wscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO1lBQUVjLFNBQVM7WUFBbURwQjtRQUFNLEdBQ3BFO1lBQUVRLFFBQVE7UUFBSTtJQUVsQixFQUFFLE9BQU9ELE9BQU87UUFDZE0sUUFBUU4sS0FBSyxDQUFDLDJDQUEyQ0E7UUFDekQsT0FBT2pCLHFEQUFZQSxDQUFDZ0IsSUFBSSxDQUN0QjtZQUFFQyxPQUFPO1FBQXdDLEdBQ2pEO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZWNvbW1lcmNlLW91dHNldC8uL2FwcC9hcGkvYXV0aC9zZXNzaW9uL3JvdXRlLnRzP2EyYWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xyXG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJztcclxuaW1wb3J0IHsgYXV0aE9wdGlvbnMgfSBmcm9tICdAL2xpYi9hdXRoT3B0aW9ucyc7XHJcbmltcG9ydCB7IHZhbGlkYXRlVG9rZW4sIGNyZWF0ZVRva2VuLCBjbGVhckFuZFJlZ2VuZXJhdGVUb2tlbnMgfSBmcm9tICdAL2xpYi9hdXRoJztcclxuaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICduZXh0LWF1dGgvand0JztcclxuXHJcbmNvbnN0IHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGdldFRva2VuKHsgcmVxOiByZXF1ZXN0LCBzZWNyZXQ6IHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCB9KTtcclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdObyBzZXNzaW9uIGZvdW5kJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IHVzZXI6IHsgaWQ6IHRva2VuLnN1Yiwgcm9sZTogdG9rZW4ucm9sZSB9IH0sXHJcbiAgICAgIHsgc3RhdHVzOiAyMDAgfVxyXG4gICAgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gL2FwaS9hdXRoL3Nlc3Npb246JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIGNoZWNrIHNlc3Npb24nIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0RW5kcG9pbnQoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKTtcclxuICAgIGNvbnNvbGUubG9nKCdUZXN0IGVuZHBvaW50IC0gU2Vzc2lvbiByZXRyaWV2ZWQgYnkgZ2V0U2VydmVyU2Vzc2lvbjonLCBzZXNzaW9uKTtcclxuICAgIHJldHVybiBzZXNzaW9uXHJcbiAgICAgID8geyBzdGF0dXM6IDIwMCwgYm9keTogc2Vzc2lvbiB9XHJcbiAgICAgIDogeyBzdGF0dXM6IDQwMSwgYm9keTogeyBlcnJvcjogJ05vIHNlc3Npb24gZm91bmQnIH0gfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignVGVzdCBlbmRwb2ludCAtIEVycm9yIGluIGdldFNlcnZlclNlc3Npb246JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3RhdHVzOiA1MDAsIGJvZHk6IHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0gfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygnQ2xlYXJpbmcgZXhpc3Rpbmcgc2Vzc2lvbiB0b2tlbnMuLi4nKTtcclxuICAgIGF3YWl0IHByaXNtYS5zZXNzaW9uLmRlbGV0ZU1hbnkoKTtcclxuICAgIGNvbnNvbGUubG9nKCdBbGwgc2Vzc2lvbiB0b2tlbnMgY2xlYXJlZC4nKTtcclxuXHJcbiAgICAvLyBFeGFtcGxlIHVzZXIgZm9yIHRlc3RpbmdcclxuICAgIGNvbnN0IHVzZXIgPSB7XHJcbiAgICAgIGlkOiAnMScsXHJcbiAgICAgIHJvbGU6ICdBRE1JTicsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlVG9rZW4odXNlcik7XHJcbiAgICBjb25zb2xlLmxvZygnTmV3IHRva2VuIGdlbmVyYXRlZDonLCB0b2tlbik7XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IG1lc3NhZ2U6ICdTZXNzaW9uIHRva2VucyBjbGVhcmVkIGFuZCBuZXcgdG9rZW4gZ2VuZXJhdGVkLicsIHRva2VuIH0sXHJcbiAgICAgIHsgc3RhdHVzOiAyMDAgfVxyXG4gICAgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xlYXJpbmcgYW5kIHJlZ2VuZXJhdGluZyB0b2tlbnM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIGNsZWFyIGFuZCByZWdlbmVyYXRlIHRva2VucycgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZ2VuZXJhdGVUb2tlbigpIHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ1JlZ2VuZXJhdGluZyBzZXNzaW9uIHRva2VucyBmb3IgdGVzdGluZy4uLicpO1xyXG5cclxuICAgIC8vIEV4YW1wbGUgdXNlciBmb3IgdGVzdGluZ1xyXG4gICAgY29uc3QgdXNlciA9IHtcclxuICAgICAgaWQ6ICcxJyxcclxuICAgICAgcm9sZTogJ0FETUlOJyxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVUb2tlbih1c2VyKTtcclxuICAgIGNvbnNvbGUubG9nKCdOZXcgdG9rZW4gZ2VuZXJhdGVkOicsIHRva2VuKTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgbWVzc2FnZTogJ05ldyB0b2tlbiBnZW5lcmF0ZWQuJywgdG9rZW4gfSxcclxuICAgICAgeyBzdGF0dXM6IDIwMCB9XHJcbiAgICApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWdlbmVyYXRpbmcgdG9rZW5zOicsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byByZWdlbmVyYXRlIHRva2VucycgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyQW5kUmVnZW5lcmF0ZVRva2Vuc1JvdXRlKCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNsZWFyQW5kUmVnZW5lcmF0ZVRva2VucygpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IG1lc3NhZ2U6ICdTZXNzaW9uIHRva2VucyBjbGVhcmVkIGFuZCBuZXcgdG9rZW4gZ2VuZXJhdGVkLicsIHRva2VuIH0sXHJcbiAgICAgIHsgc3RhdHVzOiAyMDAgfVxyXG4gICAgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xlYXJpbmcgYW5kIHJlZ2VuZXJhdGluZyB0b2tlbnM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIGNsZWFyIGFuZCByZWdlbmVyYXRlIHRva2VucycgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJQcmlzbWFDbGllbnQiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJjcmVhdGVUb2tlbiIsImNsZWFyQW5kUmVnZW5lcmF0ZVRva2VucyIsImdldFRva2VuIiwicHJpc21hIiwiR0VUIiwicmVxdWVzdCIsInRva2VuIiwicmVxIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIk5FWFRBVVRIX1NFQ1JFVCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInVzZXIiLCJpZCIsInN1YiIsInJvbGUiLCJjb25zb2xlIiwidGVzdEVuZHBvaW50Iiwic2Vzc2lvbiIsImxvZyIsImJvZHkiLCJQT1NUIiwiZGVsZXRlTWFueSIsIm1lc3NhZ2UiLCJyZWdlbmVyYXRlVG9rZW4iLCJjbGVhckFuZFJlZ2VuZXJhdGVUb2tlbnNSb3V0ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/session/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* reexport safe */ _authOptions__WEBPACK_IMPORTED_MODULE_1__.authOptions),\n/* harmony export */   clearAndRegenerateTokens: () => (/* binding */ clearAndRegenerateTokens),\n/* harmony export */   createToken: () => (/* binding */ createToken),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   hasPermission: () => (/* binding */ hasPermission),\n/* harmony export */   isAdmin: () => (/* binding */ isAdmin),\n/* harmony export */   isAuthenticated: () => (/* binding */ isAuthenticated),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requirePermission: () => (/* binding */ requirePermission),\n/* harmony export */   validateToken: () => (/* binding */ validateToken)\n/* harmony export */ });\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/next */ \"(rsc)/./node_modules/next-auth/next/index.js\");\n/* harmony import */ var _authOptions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./authOptions */ \"(rsc)/./lib/authOptions.ts\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_3__.PrismaClient();\n\nasync function getSession() {\n    console.log(\"getSession - Retrieving session using getServerSession\");\n    return await (0,next_auth_next__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(_authOptions__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n}\nasync function getCurrentUser() {\n    const session = await getSession();\n    console.log(\"getCurrentUser - Session retrieved:\", session);\n    return session?.user ?? null;\n}\nasync function requireAuth() {\n    const user = await getCurrentUser();\n    if (!user) {\n        console.log(\"requireAuth - Authentication required, no user found\");\n        throw new Error(\"Authentication required\");\n    }\n    return user;\n}\nasync function requireAdmin() {\n    const user = await getCurrentUser();\n    if (!user || user.role !== \"admin\") {\n        console.log(\"requireAdmin - Admin access required, user:\", user);\n        throw new Error(\"Admin access required\");\n    }\n    return user;\n}\nasync function requirePermission(permission) {\n    const user = await getCurrentUser();\n    if (!user || !user.permissions?.includes(permission)) {\n        console.log(`requirePermission - Permission ${permission} required, user:`, user);\n        throw new Error(`Permission ${permission} required`);\n    }\n    return user;\n}\nasync function isAuthenticated() {\n    const user = await getCurrentUser();\n    return !!user;\n}\nasync function isAdmin() {\n    const user = await getCurrentUser();\n    return !!user && user.role === \"admin\";\n}\nasync function hasPermission(permission) {\n    const user = await getCurrentUser();\n    return !!user && !!user.permissions?.includes(permission);\n}\nfunction validateToken(token) {\n    try {\n        console.log(\"Validating token:\", token);\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default().verify(token, process.env.NEXTAUTH_SECRET);\n        console.log(\"Token successfully validated:\", decoded);\n        return decoded;\n    } catch (error) {\n        console.error(\"Error validating token:\", error);\n        return null;\n    }\n}\nasync function createToken(user) {\n    try {\n        console.log(\"Creating token for user:\", user);\n        const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default().sign({\n            id: user.id,\n            role: user.role\n        }, process.env.NEXTAUTH_SECRET, {\n            expiresIn: \"1h\"\n        });\n        console.log(\"Token created:\", token);\n        return token;\n    } catch (error) {\n        console.error(\"Error creating token:\", error);\n        throw error;\n    }\n}\nasync function clearAndRegenerateTokens() {\n    try {\n        console.log(\"Clearing existing session tokens...\");\n        await prisma.session.deleteMany();\n        console.log(\"All session tokens cleared.\");\n        // Example user for testing\n        const user = {\n            id: \"1\",\n            role: \"ADMIN\"\n        };\n        const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default().sign({\n            id: user.id,\n            role: user.role\n        }, process.env.NEXTAUTH_SECRET, {\n            expiresIn: \"1h\"\n        });\n        console.log(\"New token generated:\", token);\n        return token;\n    } catch (error) {\n        console.error(\"Error clearing and regenerating tokens:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNSO1FBRUEsTUFBTVMsUUFBUXJCLHdEQUFRLENBQ3BCO1lBQUU4QixJQUFJdEIsS0FBS3NCLEVBQUU7WUFBRWxCLE1BQU1KLEtBQUtJLElBQUk7UUFBQyxHQUMvQlksUUFBUUMsR0FBRyxDQUFDQyxlQUFlLEVBQzNCO1lBQUVLLFdBQVc7UUFBSztRQUVwQjNCLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JnQjtRQUVwQyxPQUFPQTtJQUNULEVBQUUsT0FBT00sT0FBTztRQUNkdkIsUUFBUXVCLEtBQUssQ0FBQywyQ0FBMkNBO1FBQ3pELE1BQU1BO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Vjb21tZXJjZS1vdXRzZXQvLi9saWIvYXV0aC50cz9iZjdlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFNlcnZlclNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgvbmV4dCc7XG5pbXBvcnQgeyBhdXRoT3B0aW9ucyB9IGZyb20gJy4vYXV0aE9wdGlvbnMnO1xuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG5jb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG5cbmV4cG9ydCB7IGF1dGhPcHRpb25zIH07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKCkge1xuICBjb25zb2xlLmxvZygnZ2V0U2Vzc2lvbiAtIFJldHJpZXZpbmcgc2Vzc2lvbiB1c2luZyBnZXRTZXJ2ZXJTZXNzaW9uJyk7XG4gIHJldHVybiBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKCkge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbigpO1xuICBjb25zb2xlLmxvZygnZ2V0Q3VycmVudFVzZXIgLSBTZXNzaW9uIHJldHJpZXZlZDonLCBzZXNzaW9uKTtcbiAgcmV0dXJuIHNlc3Npb24/LnVzZXIgPz8gbnVsbDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKCkge1xuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0Q3VycmVudFVzZXIoKTtcbiAgaWYgKCF1c2VyKSB7XG4gICAgY29uc29sZS5sb2coJ3JlcXVpcmVBdXRoIC0gQXV0aGVudGljYXRpb24gcmVxdWlyZWQsIG5vIHVzZXIgZm91bmQnKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyk7XG4gIH1cbiAgcmV0dXJuIHVzZXI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQWRtaW4oKSB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpO1xuICBpZiAoIXVzZXIgfHwgdXNlci5yb2xlICE9PSAnYWRtaW4nKSB7XG4gICAgY29uc29sZS5sb2coJ3JlcXVpcmVBZG1pbiAtIEFkbWluIGFjY2VzcyByZXF1aXJlZCwgdXNlcjonLCB1c2VyKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FkbWluIGFjY2VzcyByZXF1aXJlZCcpO1xuICB9XG4gIHJldHVybiB1c2VyO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBlcm1pc3Npb24ocGVybWlzc2lvbjogc3RyaW5nKSB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpO1xuICBpZiAoIXVzZXIgfHwgIXVzZXIucGVybWlzc2lvbnM/LmluY2x1ZGVzKHBlcm1pc3Npb24pKSB7XG4gICAgY29uc29sZS5sb2coYHJlcXVpcmVQZXJtaXNzaW9uIC0gUGVybWlzc2lvbiAke3Blcm1pc3Npb259IHJlcXVpcmVkLCB1c2VyOmAsIHVzZXIpO1xuICAgIHRocm93IG5ldyBFcnJvcihgUGVybWlzc2lvbiAke3Blcm1pc3Npb259IHJlcXVpcmVkYCk7XG4gIH1cbiAgcmV0dXJuIHVzZXI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpO1xuICByZXR1cm4gISF1c2VyO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNBZG1pbigpIHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldEN1cnJlbnRVc2VyKCk7XG4gIHJldHVybiAhIXVzZXIgJiYgdXNlci5yb2xlID09PSAnYWRtaW4nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzUGVybWlzc2lvbihwZXJtaXNzaW9uOiBzdHJpbmcpIHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldEN1cnJlbnRVc2VyKCk7XG4gIHJldHVybiAhIXVzZXIgJiYgISF1c2VyLnBlcm1pc3Npb25zPy5pbmNsdWRlcyhwZXJtaXNzaW9uKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVG9rZW4odG9rZW4pIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnVmFsaWRhdGluZyB0b2tlbjonLCB0b2tlbik7XG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCk7XG4gICAgY29uc29sZS5sb2coJ1Rva2VuIHN1Y2Nlc3NmdWxseSB2YWxpZGF0ZWQ6JywgZGVjb2RlZCk7XG4gICAgcmV0dXJuIGRlY29kZWQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmFsaWRhdGluZyB0b2tlbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKHVzZXIpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgdG9rZW4gZm9yIHVzZXI6JywgdXNlcik7XG4gICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbihcbiAgICAgIHsgaWQ6IHVzZXIuaWQsIHJvbGU6IHVzZXIucm9sZSB9LFxuICAgICAgcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVULFxuICAgICAgeyBleHBpcmVzSW46ICcxaCcgfVxuICAgICk7XG4gICAgY29uc29sZS5sb2coJ1Rva2VuIGNyZWF0ZWQ6JywgdG9rZW4pO1xuICAgIHJldHVybiB0b2tlbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyB0b2tlbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyQW5kUmVnZW5lcmF0ZVRva2VucygpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnQ2xlYXJpbmcgZXhpc3Rpbmcgc2Vzc2lvbiB0b2tlbnMuLi4nKTtcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGVNYW55KCk7XG4gICAgY29uc29sZS5sb2coJ0FsbCBzZXNzaW9uIHRva2VucyBjbGVhcmVkLicpO1xuXG4gICAgLy8gRXhhbXBsZSB1c2VyIGZvciB0ZXN0aW5nXG4gICAgY29uc3QgdXNlciA9IHtcbiAgICAgIGlkOiAnMScsXG4gICAgICByb2xlOiAnQURNSU4nLFxuICAgIH07XG5cbiAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKFxuICAgICAgeyBpZDogdXNlci5pZCwgcm9sZTogdXNlci5yb2xlIH0sXG4gICAgICBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQsXG4gICAgICB7IGV4cGlyZXNJbjogJzFoJyB9XG4gICAgKTtcbiAgICBjb25zb2xlLmxvZygnTmV3IHRva2VuIGdlbmVyYXRlZDonLCB0b2tlbik7XG5cbiAgICByZXR1cm4gdG9rZW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xlYXJpbmcgYW5kIHJlZ2VuZXJhdGluZyB0b2tlbnM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59Il0sIm5hbWVzIjpbImdldFNlcnZlclNlc3Npb24iLCJhdXRoT3B0aW9ucyIsImp3dCIsIlByaXNtYUNsaWVudCIsInByaXNtYSIsImdldFNlc3Npb24iLCJjb25zb2xlIiwibG9nIiwiZ2V0Q3VycmVudFVzZXIiLCJzZXNzaW9uIiwidXNlciIsInJlcXVpcmVBdXRoIiwiRXJyb3IiLCJyZXF1aXJlQWRtaW4iLCJyb2xlIiwicmVxdWlyZVBlcm1pc3Npb24iLCJwZXJtaXNzaW9uIiwicGVybWlzc2lvbnMiLCJpbmNsdWRlcyIsImlzQXV0aGVudGljYXRlZCIsImlzQWRtaW4iLCJoYXNQZXJtaXNzaW9uIiwidmFsaWRhdGVUb2tlbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJORVhUQVVUSF9TRUNSRVQiLCJlcnJvciIsImNyZWF0ZVRva2VuIiwic2lnbiIsImlkIiwiZXhwaXJlc0luIiwiY2xlYXJBbmRSZWdlbmVyYXRlVG9rZW5zIiwiZGVsZXRlTWFueSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/authOptions.ts":
/*!****************************!*\
  !*** ./lib/authOptions.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/prisma.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var _security__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./security */ \"(rsc)/./lib/security.ts\");\n\n\n\n\n\nconsole.log(\"NEXTAUTH_SECRET:\", process.env.NEXTAUTH_SECRET);\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: \"Credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                },\n                twoFactorCode: {\n                    label: \"2FA Code\",\n                    type: \"text\",\n                    optional: true\n                },\n                userId: {\n                    label: \"User ID\",\n                    type: \"text\",\n                    optional: true\n                },\n                rememberDevice: {\n                    label: \"Remember Device\",\n                    type: \"checkbox\",\n                    optional: true\n                }\n            },\n            async authorize (credentials, req) {\n                const ipAddress = req?.headers[\"x-forwarded-for\"] || req?.headers[\"x-real-ip\"] || \"\";\n                const userAgent = req?.headers[\"user-agent\"] || \"\";\n                // If userId and twoFactorCode are provided, this is a 2FA verification step\n                if (credentials?.userId && credentials?.twoFactorCode) {\n                    const user = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                        where: {\n                            id: credentials.userId\n                        }\n                    });\n                    if (!user || !user.twoFactorEnabled || !user.twoFactorSecret) {\n                        throw new Error(\"2FA not enabled\");\n                    }\n                    const speakeasy = (await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/base32.js\"), __webpack_require__.e(\"vendor-chunks/speakeasy\")]).then(__webpack_require__.t.bind(__webpack_require__, /*! speakeasy */ \"(rsc)/./node_modules/speakeasy/index.js\", 19))).default;\n                    const verified = speakeasy.totp.verify({\n                        secret: user.twoFactorSecret,\n                        encoding: \"base32\",\n                        token: credentials.twoFactorCode,\n                        window: 1\n                    });\n                    if (!verified) {\n                        await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                            userId: user.id,\n                            email: user.email,\n                            ipAddress,\n                            userAgent\n                        }, false);\n                        throw new Error(\"Invalid 2FA code\");\n                    }\n                    // 2FA passed, record success and trust device if requested\n                    await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                        userId: user.id,\n                        email: user.email,\n                        ipAddress,\n                        userAgent\n                    }, true);\n                    if (credentials.rememberDevice) {\n                        await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.trustDevice(user.id, userAgent, ipAddress);\n                    }\n                    return user;\n                }\n                // Normal login step\n                if (!credentials?.email || !credentials?.password) {\n                    return null;\n                }\n                const user = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                    where: {\n                        email: credentials.email\n                    }\n                });\n                if (!user || !user.password) {\n                    return null;\n                }\n                const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_3__[\"default\"].compare(credentials.password, user.password);\n                if (!isValid) {\n                    await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                        userId: user.id,\n                        email: user.email,\n                        ipAddress,\n                        userAgent\n                    }, false);\n                    return null;\n                }\n                // Assess risk\n                const risk = await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.assessLoginRisk({\n                    userId: user.id,\n                    email: user.email,\n                    ipAddress,\n                    userAgent\n                });\n                if (risk.requires2FA && !user.twoFactorEnabled) {\n                    // If high risk but 2FA not enabled, block login\n                    await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                        userId: user.id,\n                        email: user.email,\n                        ipAddress,\n                        userAgent\n                    }, false);\n                    throw new Error(\"High risk login: 2FA required but not enabled.\");\n                }\n                if (user.twoFactorEnabled && !credentials?.twoFactorCode) {\n                    // 2FA required, throw special error\n                    await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                        userId: user.id,\n                        email: user.email,\n                        ipAddress,\n                        userAgent\n                    }, true);\n                    throw new Error(`2FA_REQUIRED:${user.id}`);\n                }\n                // If high risk and not a trusted device, require 2FA\n                if (risk.requiresTrustedDevice) {\n                    await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                        userId: user.id,\n                        email: user.email,\n                        ipAddress,\n                        userAgent\n                    }, false);\n                    throw new Error(\"Untrusted device: Please verify this device.\");\n                }\n                // No 2FA or trusted device required, record success\n                await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.recordLoginAttempt({\n                    userId: user.id,\n                    email: user.email,\n                    ipAddress,\n                    userAgent\n                }, true);\n                if (credentials.rememberDevice) {\n                    await _security__WEBPACK_IMPORTED_MODULE_4__.SecurityService.trustDevice(user.id, userAgent, ipAddress);\n                }\n                return user;\n            }\n        }),\n        (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            clientId: process.env.GOOGLE_CLIENT_ID,\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET\n        })\n    ],\n    session: {\n        strategy: \"jwt\"\n    },\n    callbacks: {\n        async signIn ({ user, account }) {\n            // For OAuth logins, ensure the user exists in the DB\n            if (account?.provider !== \"credentials\") {\n                let dbUser = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                    where: {\n                        email: user.email\n                    }\n                });\n                if (!dbUser) {\n                    // Optionally, set default role to 'sales' or 'USER'\n                    dbUser = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.create({\n                        data: {\n                            email: user.email,\n                            name: user.name,\n                            role: \"sales\",\n                            emailVerified: true\n                        }\n                    });\n                }\n            }\n            return true;\n        },\n        async jwt ({ token, user }) {\n            // Always fetch the latest role from the database for returning users (including OAuth)\n            if (token?.email) {\n                const dbUser = await _prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({\n                    where: {\n                        email: token.email\n                    }\n                });\n                if (dbUser) {\n                    token.role = dbUser.role || \"USER\";\n                    token.sub = dbUser.id;\n                }\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (session.user) {\n                session.user.id = token.sub;\n                session.user.role = token.role;\n            }\n            return session;\n        },\n        async redirect ({ url, baseUrl, token }) {\n            const role = token?.role;\n            if (role === \"sales\") {\n                return `${baseUrl}/sales/dashboard`;\n            }\n            return `${baseUrl}/dashboard`;\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SWMsT0FBTzNCLE9BQU87Z0JBQ2hCLE1BQU0rQyxTQUFTLE1BQU0zRCwyQ0FBTUEsQ0FBQ3lCLElBQUksQ0FBQ0MsVUFBVSxDQUFDO29CQUFFQyxPQUFPO3dCQUFFZixPQUFPMkIsTUFBTTNCLEtBQUs7b0JBQUM7Z0JBQUU7Z0JBQzVFLElBQUkrQyxRQUFRO29CQUNWcEIsTUFBTXVCLElBQUksR0FBR0gsT0FBT0csSUFBSSxJQUFJO29CQUM1QnZCLE1BQU0wQixHQUFHLEdBQUdOLE9BQU8vQixFQUFFO2dCQUN2QjtZQUNGO1lBQ0EsT0FBT1c7UUFDVDtRQUNBLE1BQU1jLFNBQVEsRUFBRUEsT0FBTyxFQUFFZCxLQUFLLEVBQUU7WUFDOUIsSUFBSWMsUUFBUTVCLElBQUksRUFBRTtnQkFDaEI0QixRQUFRNUIsSUFBSSxDQUFDRyxFQUFFLEdBQUdXLE1BQU0wQixHQUFHO2dCQUMzQlosUUFBUTVCLElBQUksQ0FBQ3FDLElBQUksR0FBR3ZCLE1BQU11QixJQUFJO1lBQ2hDO1lBQ0EsT0FBT1Q7UUFDVDtRQUNBLE1BQU1hLFVBQVMsRUFBRUMsR0FBRyxFQUFFQyxPQUFPLEVBQUU3QixLQUFLLEVBQUU7WUFDcEMsTUFBTXVCLE9BQU92QixPQUFPdUI7WUFDcEIsSUFBSUEsU0FBUyxTQUFTO2dCQUNwQixPQUFPLENBQUMsRUFBRU0sUUFBUSxnQkFBZ0IsQ0FBQztZQUNyQztZQUNBLE9BQU8sQ0FBQyxFQUFFQSxRQUFRLFVBQVUsQ0FBQztRQUMvQjtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL2Vjb21tZXJjZS1vdXRzZXQvLi9saWIvYXV0aE9wdGlvbnMudHM/OTExMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2NyZWRlbnRpYWxzJztcbmltcG9ydCBHb29nbGVQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2dvb2dsZSc7XG5pbXBvcnQgdHlwZSB7IE5leHRBdXRoT3B0aW9ucyB9IGZyb20gJ25leHQtYXV0aCc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL3ByaXNtYSc7XG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcbmltcG9ydCB7IFNlY3VyaXR5U2VydmljZSB9IGZyb20gJy4vc2VjdXJpdHknO1xuXG5jb25zb2xlLmxvZygnTkVYVEFVVEhfU0VDUkVUOicsIHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCk7XG5cbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9uczogTmV4dEF1dGhPcHRpb25zID0ge1xuICBwcm92aWRlcnM6IFtcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcbiAgICAgIG5hbWU6ICdDcmVkZW50aWFscycsXG4gICAgICBjcmVkZW50aWFsczoge1xuICAgICAgICBlbWFpbDogeyBsYWJlbDogJ0VtYWlsJywgdHlwZTogJ2VtYWlsJyB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogJ1Bhc3N3b3JkJywgdHlwZTogJ3Bhc3N3b3JkJyB9LFxuICAgICAgICB0d29GYWN0b3JDb2RlOiB7IGxhYmVsOiAnMkZBIENvZGUnLCB0eXBlOiAndGV4dCcsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgICAgIHVzZXJJZDogeyBsYWJlbDogJ1VzZXIgSUQnLCB0eXBlOiAndGV4dCcsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgICAgIHJlbWVtYmVyRGV2aWNlOiB7IGxhYmVsOiAnUmVtZW1iZXIgRGV2aWNlJywgdHlwZTogJ2NoZWNrYm94Jywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICAgIH0sXG4gICAgICBhc3luYyBhdXRob3JpemUoY3JlZGVudGlhbHMsIHJlcSkge1xuICAgICAgICBjb25zdCBpcEFkZHJlc3MgPSByZXE/LmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddIHx8IHJlcT8uaGVhZGVyc1sneC1yZWFsLWlwJ10gfHwgJyc7XG4gICAgICAgIGNvbnN0IHVzZXJBZ2VudCA9IHJlcT8uaGVhZGVyc1sndXNlci1hZ2VudCddIHx8ICcnO1xuICAgICAgICAvLyBJZiB1c2VySWQgYW5kIHR3b0ZhY3RvckNvZGUgYXJlIHByb3ZpZGVkLCB0aGlzIGlzIGEgMkZBIHZlcmlmaWNhdGlvbiBzdGVwXG4gICAgICAgIGlmIChjcmVkZW50aWFscz8udXNlcklkICYmIGNyZWRlbnRpYWxzPy50d29GYWN0b3JDb2RlKSB7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogY3JlZGVudGlhbHMudXNlcklkIH0gfSk7XG4gICAgICAgICAgaWYgKCF1c2VyIHx8ICEodXNlciBhcyBhbnkpLnR3b0ZhY3RvckVuYWJsZWQgfHwgISh1c2VyIGFzIGFueSkudHdvRmFjdG9yU2VjcmV0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJzJGQSBub3QgZW5hYmxlZCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzcGVha2Vhc3kgPSAoYXdhaXQgaW1wb3J0KCdzcGVha2Vhc3knKSkuZGVmYXVsdDtcbiAgICAgICAgICBjb25zdCB2ZXJpZmllZCA9IHNwZWFrZWFzeS50b3RwLnZlcmlmeSh7XG4gICAgICAgICAgICBzZWNyZXQ6ICh1c2VyIGFzIGFueSkudHdvRmFjdG9yU2VjcmV0LFxuICAgICAgICAgICAgZW5jb2Rpbmc6ICdiYXNlMzInLFxuICAgICAgICAgICAgdG9rZW46IGNyZWRlbnRpYWxzLnR3b0ZhY3RvckNvZGUsXG4gICAgICAgICAgICB3aW5kb3c6IDEsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCF2ZXJpZmllZCkge1xuICAgICAgICAgICAgYXdhaXQgU2VjdXJpdHlTZXJ2aWNlLnJlY29yZExvZ2luQXR0ZW1wdCh7XG4gICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGlwQWRkcmVzcyxcbiAgICAgICAgICAgICAgdXNlckFnZW50LFxuICAgICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIDJGQSBjb2RlJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIDJGQSBwYXNzZWQsIHJlY29yZCBzdWNjZXNzIGFuZCB0cnVzdCBkZXZpY2UgaWYgcmVxdWVzdGVkXG4gICAgICAgICAgYXdhaXQgU2VjdXJpdHlTZXJ2aWNlLnJlY29yZExvZ2luQXR0ZW1wdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIGlwQWRkcmVzcyxcbiAgICAgICAgICAgIHVzZXJBZ2VudCxcbiAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICBpZiAoY3JlZGVudGlhbHMucmVtZW1iZXJEZXZpY2UpIHtcbiAgICAgICAgICAgIGF3YWl0IFNlY3VyaXR5U2VydmljZS50cnVzdERldmljZSh1c2VyLmlkLCB1c2VyQWdlbnQsIGlwQWRkcmVzcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB1c2VyO1xuICAgICAgICB9XG4gICAgICAgIC8vIE5vcm1hbCBsb2dpbiBzdGVwXG4gICAgICAgIGlmICghY3JlZGVudGlhbHM/LmVtYWlsIHx8ICFjcmVkZW50aWFscz8ucGFzc3dvcmQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGVtYWlsOiBjcmVkZW50aWFscy5lbWFpbCB9IH0pO1xuICAgICAgICBpZiAoIXVzZXIgfHwgIXVzZXIucGFzc3dvcmQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoY3JlZGVudGlhbHMucGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xuICAgICAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgICBhd2FpdCBTZWN1cml0eVNlcnZpY2UucmVjb3JkTG9naW5BdHRlbXB0KHtcbiAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgaXBBZGRyZXNzLFxuICAgICAgICAgICAgdXNlckFnZW50LFxuICAgICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICAvLyBBc3Nlc3Mgcmlza1xuICAgICAgICBjb25zdCByaXNrID0gYXdhaXQgU2VjdXJpdHlTZXJ2aWNlLmFzc2Vzc0xvZ2luUmlzayh7XG4gICAgICAgICAgdXNlcklkOiB1c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGlwQWRkcmVzcyxcbiAgICAgICAgICB1c2VyQWdlbnQsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAocmlzay5yZXF1aXJlczJGQSAmJiAhKHVzZXIgYXMgYW55KS50d29GYWN0b3JFbmFibGVkKSB7XG4gICAgICAgICAgLy8gSWYgaGlnaCByaXNrIGJ1dCAyRkEgbm90IGVuYWJsZWQsIGJsb2NrIGxvZ2luXG4gICAgICAgICAgYXdhaXQgU2VjdXJpdHlTZXJ2aWNlLnJlY29yZExvZ2luQXR0ZW1wdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIGlwQWRkcmVzcyxcbiAgICAgICAgICAgIHVzZXJBZ2VudCxcbiAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIaWdoIHJpc2sgbG9naW46IDJGQSByZXF1aXJlZCBidXQgbm90IGVuYWJsZWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCh1c2VyIGFzIGFueSkudHdvRmFjdG9yRW5hYmxlZCAmJiAhY3JlZGVudGlhbHM/LnR3b0ZhY3RvckNvZGUpIHtcbiAgICAgICAgICAvLyAyRkEgcmVxdWlyZWQsIHRocm93IHNwZWNpYWwgZXJyb3JcbiAgICAgICAgICBhd2FpdCBTZWN1cml0eVNlcnZpY2UucmVjb3JkTG9naW5BdHRlbXB0KHtcbiAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgaXBBZGRyZXNzLFxuICAgICAgICAgICAgdXNlckFnZW50LFxuICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgMkZBX1JFUVVJUkVEOiR7dXNlci5pZH1gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBoaWdoIHJpc2sgYW5kIG5vdCBhIHRydXN0ZWQgZGV2aWNlLCByZXF1aXJlIDJGQVxuICAgICAgICBpZiAocmlzay5yZXF1aXJlc1RydXN0ZWREZXZpY2UpIHtcbiAgICAgICAgICBhd2FpdCBTZWN1cml0eVNlcnZpY2UucmVjb3JkTG9naW5BdHRlbXB0KHtcbiAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgaXBBZGRyZXNzLFxuICAgICAgICAgICAgdXNlckFnZW50LFxuICAgICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VudHJ1c3RlZCBkZXZpY2U6IFBsZWFzZSB2ZXJpZnkgdGhpcyBkZXZpY2UuJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm8gMkZBIG9yIHRydXN0ZWQgZGV2aWNlIHJlcXVpcmVkLCByZWNvcmQgc3VjY2Vzc1xuICAgICAgICBhd2FpdCBTZWN1cml0eVNlcnZpY2UucmVjb3JkTG9naW5BdHRlbXB0KHtcbiAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgaXBBZGRyZXNzLFxuICAgICAgICAgIHVzZXJBZ2VudCxcbiAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIGlmIChjcmVkZW50aWFscy5yZW1lbWJlckRldmljZSkge1xuICAgICAgICAgIGF3YWl0IFNlY3VyaXR5U2VydmljZS50cnVzdERldmljZSh1c2VyLmlkLCB1c2VyQWdlbnQsIGlwQWRkcmVzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVzZXI7XG4gICAgICB9LFxuICAgIH0pLFxuICAgIEdvb2dsZVByb3ZpZGVyKHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX0lEISxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQhLFxuICAgIH0pLFxuICBdLFxuICBzZXNzaW9uOiB7IHN0cmF0ZWd5OiAnand0JyB9LFxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50IH0pIHtcbiAgICAgIC8vIEZvciBPQXV0aCBsb2dpbnMsIGVuc3VyZSB0aGUgdXNlciBleGlzdHMgaW4gdGhlIERCXG4gICAgICBpZiAoYWNjb3VudD8ucHJvdmlkZXIgIT09ICdjcmVkZW50aWFscycpIHtcbiAgICAgICAgbGV0IGRiVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbDogdXNlci5lbWFpbCB9IH0pO1xuICAgICAgICBpZiAoIWRiVXNlcikge1xuICAgICAgICAgIC8vIE9wdGlvbmFsbHksIHNldCBkZWZhdWx0IHJvbGUgdG8gJ3NhbGVzJyBvciAnVVNFUidcbiAgICAgICAgICBkYlVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5jcmVhdGUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICByb2xlOiAnc2FsZXMnLCAvLyBvciAnVVNFUicgYXMgZGVmYXVsdFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9KSB7XG4gICAgICAvLyBBbHdheXMgZmV0Y2ggdGhlIGxhdGVzdCByb2xlIGZyb20gdGhlIGRhdGFiYXNlIGZvciByZXR1cm5pbmcgdXNlcnMgKGluY2x1ZGluZyBPQXV0aClcbiAgICAgIGlmICh0b2tlbj8uZW1haWwpIHtcbiAgICAgICAgY29uc3QgZGJVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGVtYWlsOiB0b2tlbi5lbWFpbCB9IH0pO1xuICAgICAgICBpZiAoZGJVc2VyKSB7XG4gICAgICAgICAgdG9rZW4ucm9sZSA9IGRiVXNlci5yb2xlIHx8ICdVU0VSJztcbiAgICAgICAgICB0b2tlbi5zdWIgPSBkYlVzZXIuaWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9LFxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICBpZiAoc2Vzc2lvbi51c2VyKSB7XG4gICAgICAgIHNlc3Npb24udXNlci5pZCA9IHRva2VuLnN1YjtcbiAgICAgICAgc2Vzc2lvbi51c2VyLnJvbGUgPSB0b2tlbi5yb2xlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfSxcbiAgICBhc3luYyByZWRpcmVjdCh7IHVybCwgYmFzZVVybCwgdG9rZW4gfSkge1xuICAgICAgY29uc3Qgcm9sZSA9IHRva2VuPy5yb2xlO1xuICAgICAgaWYgKHJvbGUgPT09ICdzYWxlcycpIHtcbiAgICAgICAgcmV0dXJuIGAke2Jhc2VVcmx9L3NhbGVzL2Rhc2hib2FyZGA7XG4gICAgICB9XG4gICAgICByZXR1cm4gYCR7YmFzZVVybH0vZGFzaGJvYXJkYDtcbiAgICB9LFxuICB9LFxufTsiXSwibmFtZXMiOlsiQ3JlZGVudGlhbHNQcm92aWRlciIsIkdvb2dsZVByb3ZpZGVyIiwicHJpc21hIiwiYmNyeXB0IiwiU2VjdXJpdHlTZXJ2aWNlIiwiY29uc29sZSIsImxvZyIsInByb2Nlc3MiLCJlbnYiLCJORVhUQVVUSF9TRUNSRVQiLCJhdXRoT3B0aW9ucyIsInByb3ZpZGVycyIsIm5hbWUiLCJjcmVkZW50aWFscyIsImVtYWlsIiwibGFiZWwiLCJ0eXBlIiwicGFzc3dvcmQiLCJ0d29GYWN0b3JDb2RlIiwib3B0aW9uYWwiLCJ1c2VySWQiLCJyZW1lbWJlckRldmljZSIsImF1dGhvcml6ZSIsInJlcSIsImlwQWRkcmVzcyIsImhlYWRlcnMiLCJ1c2VyQWdlbnQiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaWQiLCJ0d29GYWN0b3JFbmFibGVkIiwidHdvRmFjdG9yU2VjcmV0IiwiRXJyb3IiLCJzcGVha2Vhc3kiLCJkZWZhdWx0IiwidmVyaWZpZWQiLCJ0b3RwIiwidmVyaWZ5Iiwic2VjcmV0IiwiZW5jb2RpbmciLCJ0b2tlbiIsIndpbmRvdyIsInJlY29yZExvZ2luQXR0ZW1wdCIsInRydXN0RGV2aWNlIiwiaXNWYWxpZCIsImNvbXBhcmUiLCJyaXNrIiwiYXNzZXNzTG9naW5SaXNrIiwicmVxdWlyZXMyRkEiLCJyZXF1aXJlc1RydXN0ZWREZXZpY2UiLCJjbGllbnRJZCIsIkdPT0dMRV9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsInNlc3Npb24iLCJzdHJhdGVneSIsImNhbGxiYWNrcyIsInNpZ25JbiIsImFjY291bnQiLCJwcm92aWRlciIsImRiVXNlciIsImNyZWF0ZSIsImRhdGEiLCJyb2xlIiwiZW1haWxWZXJpZmllZCIsImp3dCIsInN1YiIsInJlZGlyZWN0IiwidXJsIiwiYmFzZVVybCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/authOptions.ts\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.js":
/*!***********************!*\
  !*** ./lib/prisma.js ***!
  \***********************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({\n    value: true\n}));\nexports.prisma = void 0;\nvar client_1 = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\nvar globalForPrisma = global;\nexports.prisma = globalForPrisma.prisma || new client_1.PrismaClient({\n    log: [\n        \"query\"\n    ]\n});\nif (true) globalForPrisma.prisma = exports.prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2JBLDhDQUE2QztJQUFFRyxPQUFPO0FBQUssQ0FBQyxFQUFDO0FBQzdERCxjQUFjLEdBQUcsS0FBSztBQUN0QixJQUFJRyxXQUFXQyxtQkFBT0EsQ0FBQyxzQ0FBZ0I7QUFDdkMsSUFBSUMsa0JBQWtCQztBQUN0Qk4sY0FBYyxHQUFHSyxnQkFBZ0JILE1BQU0sSUFDbkMsSUFBSUMsU0FBU0ksWUFBWSxDQUFDO0lBQ3RCQyxLQUFLO1FBQUM7S0FBUTtBQUNsQjtBQUNKLElBQUlDLElBQXlCLEVBQ3pCSixnQkFBZ0JILE1BQU0sR0FBR0YsUUFBUUUsTUFBTSIsInNvdXJjZXMiOlsid2VicGFjazovL2Vjb21tZXJjZS1vdXRzZXQvLi9saWIvcHJpc21hLmpzPzc1MTUiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnByaXNtYSA9IHZvaWQgMDtcbnZhciBjbGllbnRfMSA9IHJlcXVpcmUoXCJAcHJpc21hL2NsaWVudFwiKTtcbnZhciBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWw7XG5leHBvcnRzLnByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgfHxcbiAgICBuZXcgY2xpZW50XzEuUHJpc21hQ2xpZW50KHtcbiAgICAgICAgbG9nOiBbJ3F1ZXJ5J11cbiAgICB9KTtcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxuICAgIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBleHBvcnRzLnByaXNtYTtcbiJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInByaXNtYSIsImNsaWVudF8xIiwicmVxdWlyZSIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbCIsIlByaXNtYUNsaWVudCIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.js\n");

/***/ }),

/***/ "(rsc)/./lib/security.ts":
/*!*************************!*\
  !*** ./lib/security.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SecurityService: () => (/* binding */ SecurityService)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/prisma */ \"(rsc)/./lib/prisma.js\");\n/* harmony import */ var ua_parser_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ua-parser-js */ \"(rsc)/./node_modules/ua-parser-js/src/main/ua-parser.mjs\");\n\n// If you see a type error for UAParser, run: npm install ua-parser-js @types/ua-parser-js\n\n// Server-side device type detection based on user agent\nfunction getDeviceType(userAgent) {\n    if (!userAgent) return \"unknown\";\n    if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(userAgent)) {\n        return \"tablet\";\n    }\n    if (/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(userAgent)) {\n        return \"mobile\";\n    }\n    return \"desktop\";\n}\nclass SecurityService {\n    static calculateRiskScore(factors) {\n        let score = 0;\n        const parser = new ua_parser_js__WEBPACK_IMPORTED_MODULE_1__.UAParser(factors.userAgent);\n        const device = parser.getDevice();\n        const browser = parser.getBrowser();\n        const os = parser.getOS();\n        // Check for known malicious IPs (implement your own IP reputation service)\n        // score += await this.checkIPReputation(factors.ipAddress);\n        // Check for suspicious user agents\n        if (!browser.name || !os.name) {\n            score += 20;\n        }\n        // Check for known bot user agents\n        if (factors.userAgent.toLowerCase().includes(\"bot\") || factors.userAgent.toLowerCase().includes(\"crawler\")) {\n            score += 30;\n        }\n        // Check for unusual device types\n        if (device.type === undefined) {\n            score += 15;\n        }\n        // Check for unusual locations (implement your own geo-location service)\n        // score += await this.checkLocationRisk(factors.location);\n        return Math.min(score, 100);\n    }\n    static async assessLoginRisk(factors) {\n        let riskScore = await this.calculateRiskScore(factors);\n        // Get user's previous login attempts\n        const previousAttempts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loginAttempt.findMany({\n            where: {\n                OR: [\n                    {\n                        email: factors.email\n                    },\n                    {\n                        userId: factors.userId\n                    }\n                ]\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: 5\n        });\n        // Calculate risk based on previous attempts\n        const failedAttempts = previousAttempts.filter((a)=>!a.success).length;\n        if (failedAttempts > 0) {\n            riskScore += failedAttempts * 10;\n        }\n        // Check if this is a known trusted device\n        const deviceId = this.generateDeviceId(factors.userAgent);\n        const trustedDevice = factors.userId ? await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.findFirst({\n            where: {\n                userId: factors.userId,\n                deviceId,\n                isTrusted: true,\n                trustExpiry: {\n                    gt: new Date()\n                }\n            }\n        }) : null;\n        return {\n            riskScore: Math.min(riskScore, 100),\n            requires2FA: riskScore >= 50,\n            requiresTrustedDevice: riskScore >= 70 && !trustedDevice\n        };\n    }\n    static async recordLoginAttempt(factors, success) {\n        const riskScore = await this.calculateRiskScore(factors);\n        const deviceId = this.generateDeviceId(factors.userAgent);\n        const deviceType = getDeviceType(factors.userAgent);\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loginAttempt.create({\n            data: {\n                userId: factors.userId,\n                email: factors.email,\n                ipAddress: factors.ipAddress,\n                userAgent: factors.userAgent,\n                success,\n                riskScore,\n                deviceType,\n                location: factors.location\n            }\n        });\n        if (success && factors.userId) {\n            // Update user's risk score\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update({\n                where: {\n                    id: factors.userId\n                },\n                data: {\n                    riskScore: riskScore,\n                    lastRiskAssessment: new Date()\n                }\n            });\n        }\n    }\n    static async trustDevice(userId, userAgent, ipAddress) {\n        const deviceId = this.generateDeviceId(userAgent);\n        const parser = new ua_parser_js__WEBPACK_IMPORTED_MODULE_1__.UAParser(userAgent);\n        const device = parser.getDevice();\n        const browser = parser.getBrowser();\n        const os = parser.getOS();\n        const deviceName = `${browser.name || \"Unknown\"} on ${os.name || \"Unknown\"} ${device.type ? `(${device.type})` : \"\"}`;\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.create({\n            data: {\n                userId,\n                deviceId,\n                deviceName,\n                deviceType: getDeviceType(userAgent),\n                ipAddress,\n                userAgent,\n                isTrusted: true,\n                trustExpiry: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 days\n            }\n        });\n    }\n    static generateDeviceId(userAgent) {\n        // Generate a unique device ID based on user agent\n        // This is a simple implementation - you might want to use a more sophisticated method\n        return Buffer.from(userAgent).toString(\"base64\");\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2VjdXJpdHkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXVDO0FBQ3ZDLDBGQUEwRjtBQUNsRDtBQVV4Qyx3REFBd0Q7QUFDeEQsU0FBU0UsY0FBY0MsU0FBaUI7SUFDdEMsSUFBSSxDQUFDQSxXQUFXLE9BQU87SUFDdkIsSUFBSSxtREFBbURDLElBQUksQ0FBQ0QsWUFBWTtRQUN0RSxPQUFPO0lBQ1Q7SUFDQSxJQUFJLHNHQUFzR0MsSUFBSSxDQUFDRCxZQUFZO1FBQ3pILE9BQU87SUFDVDtJQUNBLE9BQU87QUFDVDtBQUVPLE1BQU1FO0lBQ1gsT0FBZUMsbUJBQW1CQyxPQUFvQixFQUFVO1FBQzlELElBQUlDLFFBQVE7UUFDWixNQUFNQyxTQUFTLElBQUlSLGtEQUFRQSxDQUFDTSxRQUFRSixTQUFTO1FBQzdDLE1BQU1PLFNBQVNELE9BQU9FLFNBQVM7UUFDL0IsTUFBTUMsVUFBVUgsT0FBT0ksVUFBVTtRQUNqQyxNQUFNQyxLQUFLTCxPQUFPTSxLQUFLO1FBRXZCLDJFQUEyRTtRQUMzRSw0REFBNEQ7UUFFNUQsbUNBQW1DO1FBQ25DLElBQUksQ0FBQ0gsUUFBUUksSUFBSSxJQUFJLENBQUNGLEdBQUdFLElBQUksRUFBRTtZQUM3QlIsU0FBUztRQUNYO1FBRUEsa0NBQWtDO1FBQ2xDLElBQUlELFFBQVFKLFNBQVMsQ0FBQ2MsV0FBVyxHQUFHQyxRQUFRLENBQUMsVUFDekNYLFFBQVFKLFNBQVMsQ0FBQ2MsV0FBVyxHQUFHQyxRQUFRLENBQUMsWUFBWTtZQUN2RFYsU0FBUztRQUNYO1FBRUEsaUNBQWlDO1FBQ2pDLElBQUlFLE9BQU9TLElBQUksS0FBS0MsV0FBVztZQUM3QlosU0FBUztRQUNYO1FBRUEsd0VBQXdFO1FBQ3hFLDJEQUEyRDtRQUUzRCxPQUFPYSxLQUFLQyxHQUFHLENBQUNkLE9BQU87SUFDekI7SUFFQSxhQUFhZSxnQkFBZ0JoQixPQUFvQixFQUk5QztRQUNELElBQUlpQixZQUFZLE1BQU0sSUFBSSxDQUFDbEIsa0JBQWtCLENBQUNDO1FBRTlDLHFDQUFxQztRQUNyQyxNQUFNa0IsbUJBQW1CLE1BQU16QiwrQ0FBTUEsQ0FBQzBCLFlBQVksQ0FBQ0MsUUFBUSxDQUFDO1lBQzFEQyxPQUFPO2dCQUNMQyxJQUFJO29CQUNGO3dCQUFFQyxPQUFPdkIsUUFBUXVCLEtBQUs7b0JBQUM7b0JBQ3ZCO3dCQUFFQyxRQUFReEIsUUFBUXdCLE1BQU07b0JBQUM7aUJBQzFCO1lBQ0g7WUFDQUMsU0FBUztnQkFBRUMsV0FBVztZQUFPO1lBQzdCQyxNQUFNO1FBQ1I7UUFFQSw0Q0FBNEM7UUFDNUMsTUFBTUMsaUJBQWlCVixpQkFBaUJXLE1BQU0sQ0FBQyxDQUFDQyxJQUE0QixDQUFDQSxFQUFFQyxPQUFPLEVBQUVDLE1BQU07UUFDOUYsSUFBSUosaUJBQWlCLEdBQUc7WUFDdEJYLGFBQWFXLGlCQUFpQjtRQUNoQztRQUVBLDBDQUEwQztRQUMxQyxNQUFNSyxXQUFXLElBQUksQ0FBQ0MsZ0JBQWdCLENBQUNsQyxRQUFRSixTQUFTO1FBQ3hELE1BQU11QyxnQkFBZ0JuQyxRQUFRd0IsTUFBTSxHQUFHLE1BQU0vQiwrQ0FBTUEsQ0FBQzBDLGFBQWEsQ0FBQ0MsU0FBUyxDQUFDO1lBQzFFZixPQUFPO2dCQUNMRyxRQUFReEIsUUFBUXdCLE1BQU07Z0JBQ3RCUztnQkFDQUksV0FBVztnQkFDWEMsYUFBYTtvQkFBRUMsSUFBSSxJQUFJQztnQkFBTztZQUNoQztRQUNGLEtBQUs7UUFFTCxPQUFPO1lBQ0x2QixXQUFXSCxLQUFLQyxHQUFHLENBQUNFLFdBQVc7WUFDL0J3QixhQUFheEIsYUFBYTtZQUMxQnlCLHVCQUF1QnpCLGFBQWEsTUFBTSxDQUFDa0I7UUFDN0M7SUFDRjtJQUVBLGFBQWFRLG1CQUFtQjNDLE9BQW9CLEVBQUUrQixPQUFnQixFQUFpQjtRQUNyRixNQUFNZCxZQUFZLE1BQU0sSUFBSSxDQUFDbEIsa0JBQWtCLENBQUNDO1FBQ2hELE1BQU1pQyxXQUFXLElBQUksQ0FBQ0MsZ0JBQWdCLENBQUNsQyxRQUFRSixTQUFTO1FBQ3hELE1BQU1nRCxhQUFhakQsY0FBY0ssUUFBUUosU0FBUztRQUVsRCxNQUFNSCwrQ0FBTUEsQ0FBQzBCLFlBQVksQ0FBQzBCLE1BQU0sQ0FBQztZQUMvQkMsTUFBTTtnQkFDSnRCLFFBQVF4QixRQUFRd0IsTUFBTTtnQkFDdEJELE9BQU92QixRQUFRdUIsS0FBSztnQkFDcEJ3QixXQUFXL0MsUUFBUStDLFNBQVM7Z0JBQzVCbkQsV0FBV0ksUUFBUUosU0FBUztnQkFDNUJtQztnQkFDQWQ7Z0JBQ0EyQjtnQkFDQUksVUFBVWhELFFBQVFnRCxRQUFRO1lBQzVCO1FBQ0Y7UUFFQSxJQUFJakIsV0FBVy9CLFFBQVF3QixNQUFNLEVBQUU7WUFDN0IsMkJBQTJCO1lBQzNCLE1BQU0vQiwrQ0FBTUEsQ0FBQ3dELElBQUksQ0FBQ0MsTUFBTSxDQUFDO2dCQUN2QjdCLE9BQU87b0JBQUU4QixJQUFJbkQsUUFBUXdCLE1BQU07Z0JBQUM7Z0JBQzVCc0IsTUFBTTtvQkFDSjdCLFdBQVdBO29CQUNYbUMsb0JBQW9CLElBQUlaO2dCQUMxQjtZQUNGO1FBQ0Y7SUFDRjtJQUVBLGFBQWFhLFlBQVk3QixNQUFjLEVBQUU1QixTQUFpQixFQUFFbUQsU0FBaUIsRUFBaUI7UUFDNUYsTUFBTWQsV0FBVyxJQUFJLENBQUNDLGdCQUFnQixDQUFDdEM7UUFDdkMsTUFBTU0sU0FBUyxJQUFJUixrREFBUUEsQ0FBQ0U7UUFDNUIsTUFBTU8sU0FBU0QsT0FBT0UsU0FBUztRQUMvQixNQUFNQyxVQUFVSCxPQUFPSSxVQUFVO1FBQ2pDLE1BQU1DLEtBQUtMLE9BQU9NLEtBQUs7UUFFdkIsTUFBTThDLGFBQWEsQ0FBQyxFQUFFakQsUUFBUUksSUFBSSxJQUFJLFVBQVUsSUFBSSxFQUFFRixHQUFHRSxJQUFJLElBQUksVUFBVSxDQUFDLEVBQUVOLE9BQU9TLElBQUksR0FBRyxDQUFDLENBQUMsRUFBRVQsT0FBT1MsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUVySCxNQUFNbkIsK0NBQU1BLENBQUMwQyxhQUFhLENBQUNVLE1BQU0sQ0FBQztZQUNoQ0MsTUFBTTtnQkFDSnRCO2dCQUNBUztnQkFDQXFCO2dCQUNBVixZQUFZakQsY0FBY0M7Z0JBQzFCbUQ7Z0JBQ0FuRDtnQkFDQXlDLFdBQVc7Z0JBQ1hDLGFBQWEsSUFBSUUsS0FBS0EsS0FBS2UsR0FBRyxLQUFLLEtBQUssS0FBSyxLQUFLLEtBQUssTUFBTSxVQUFVO1lBQ3pFO1FBQ0Y7SUFDRjtJQUVBLE9BQWVyQixpQkFBaUJ0QyxTQUFpQixFQUFVO1FBQ3pELGtEQUFrRDtRQUNsRCxzRkFBc0Y7UUFDdEYsT0FBTzRELE9BQU9DLElBQUksQ0FBQzdELFdBQVc4RCxRQUFRLENBQUM7SUFDekM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Vjb21tZXJjZS1vdXRzZXQvLi9saWIvc2VjdXJpdHkudHM/MTkwYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi9saWIvcHJpc21hJztcbi8vIElmIHlvdSBzZWUgYSB0eXBlIGVycm9yIGZvciBVQVBhcnNlciwgcnVuOiBucG0gaW5zdGFsbCB1YS1wYXJzZXItanMgQHR5cGVzL3VhLXBhcnNlci1qc1xuaW1wb3J0IHsgVUFQYXJzZXIgfSBmcm9tICd1YS1wYXJzZXItanMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJpc2tGYWN0b3JzIHtcbiAgaXBBZGRyZXNzOiBzdHJpbmc7XG4gIHVzZXJBZ2VudDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICB1c2VySWQ/OiBzdHJpbmc7XG4gIGxvY2F0aW9uPzogYW55O1xufVxuXG4vLyBTZXJ2ZXItc2lkZSBkZXZpY2UgdHlwZSBkZXRlY3Rpb24gYmFzZWQgb24gdXNlciBhZ2VudFxuZnVuY3Rpb24gZ2V0RGV2aWNlVHlwZSh1c2VyQWdlbnQ6IHN0cmluZyk6ICdkZXNrdG9wJyB8ICdtb2JpbGUnIHwgJ3RhYmxldCcgfCAndW5rbm93bicge1xuICBpZiAoIXVzZXJBZ2VudCkgcmV0dXJuICd1bmtub3duJztcbiAgaWYgKC8odGFibGV0fGlwYWR8cGxheWJvb2t8c2lsayl8KGFuZHJvaWQoPyEuKm1vYmkpKS9pLnRlc3QodXNlckFnZW50KSkge1xuICAgIHJldHVybiAndGFibGV0JztcbiAgfVxuICBpZiAoL01vYmlsZXxpUChob25lfG9kKXxBbmRyb2lkfEJsYWNrQmVycnl8SUVNb2JpbGV8S2luZGxlfFNpbGstQWNjZWxlcmF0ZWR8KGhwd3x3ZWIpT1N8T3BlcmEgTShvYml8aW5pKS8udGVzdCh1c2VyQWdlbnQpKSB7XG4gICAgcmV0dXJuICdtb2JpbGUnO1xuICB9XG4gIHJldHVybiAnZGVza3RvcCc7XG59XG5cbmV4cG9ydCBjbGFzcyBTZWN1cml0eVNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVSaXNrU2NvcmUoZmFjdG9yczogUmlza0ZhY3RvcnMpOiBudW1iZXIge1xuICAgIGxldCBzY29yZSA9IDA7XG4gICAgY29uc3QgcGFyc2VyID0gbmV3IFVBUGFyc2VyKGZhY3RvcnMudXNlckFnZW50KTtcbiAgICBjb25zdCBkZXZpY2UgPSBwYXJzZXIuZ2V0RGV2aWNlKCk7XG4gICAgY29uc3QgYnJvd3NlciA9IHBhcnNlci5nZXRCcm93c2VyKCk7XG4gICAgY29uc3Qgb3MgPSBwYXJzZXIuZ2V0T1MoKTtcblxuICAgIC8vIENoZWNrIGZvciBrbm93biBtYWxpY2lvdXMgSVBzIChpbXBsZW1lbnQgeW91ciBvd24gSVAgcmVwdXRhdGlvbiBzZXJ2aWNlKVxuICAgIC8vIHNjb3JlICs9IGF3YWl0IHRoaXMuY2hlY2tJUFJlcHV0YXRpb24oZmFjdG9ycy5pcEFkZHJlc3MpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIHN1c3BpY2lvdXMgdXNlciBhZ2VudHNcbiAgICBpZiAoIWJyb3dzZXIubmFtZSB8fCAhb3MubmFtZSkge1xuICAgICAgc2NvcmUgKz0gMjA7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGtub3duIGJvdCB1c2VyIGFnZW50c1xuICAgIGlmIChmYWN0b3JzLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdib3QnKSB8fCBcbiAgICAgICAgZmFjdG9ycy51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY3Jhd2xlcicpKSB7XG4gICAgICBzY29yZSArPSAzMDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgdW51c3VhbCBkZXZpY2UgdHlwZXNcbiAgICBpZiAoZGV2aWNlLnR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgc2NvcmUgKz0gMTU7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHVudXN1YWwgbG9jYXRpb25zIChpbXBsZW1lbnQgeW91ciBvd24gZ2VvLWxvY2F0aW9uIHNlcnZpY2UpXG4gICAgLy8gc2NvcmUgKz0gYXdhaXQgdGhpcy5jaGVja0xvY2F0aW9uUmlzayhmYWN0b3JzLmxvY2F0aW9uKTtcblxuICAgIHJldHVybiBNYXRoLm1pbihzY29yZSwgMTAwKTtcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBhc3Nlc3NMb2dpblJpc2soZmFjdG9yczogUmlza0ZhY3RvcnMpOiBQcm9taXNlPHtcbiAgICByaXNrU2NvcmU6IG51bWJlcjtcbiAgICByZXF1aXJlczJGQTogYm9vbGVhbjtcbiAgICByZXF1aXJlc1RydXN0ZWREZXZpY2U6IGJvb2xlYW47XG4gIH0+IHtcbiAgICBsZXQgcmlza1Njb3JlID0gYXdhaXQgdGhpcy5jYWxjdWxhdGVSaXNrU2NvcmUoZmFjdG9ycyk7XG4gICAgXG4gICAgLy8gR2V0IHVzZXIncyBwcmV2aW91cyBsb2dpbiBhdHRlbXB0c1xuICAgIGNvbnN0IHByZXZpb3VzQXR0ZW1wdHMgPSBhd2FpdCBwcmlzbWEubG9naW5BdHRlbXB0LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIE9SOiBbXG4gICAgICAgICAgeyBlbWFpbDogZmFjdG9ycy5lbWFpbCB9LFxuICAgICAgICAgIHsgdXNlcklkOiBmYWN0b3JzLnVzZXJJZCB9XG4gICAgICAgIF1cbiAgICAgIH0sXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB0YWtlOiA1XG4gICAgfSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgcmlzayBiYXNlZCBvbiBwcmV2aW91cyBhdHRlbXB0c1xuICAgIGNvbnN0IGZhaWxlZEF0dGVtcHRzID0gcHJldmlvdXNBdHRlbXB0cy5maWx0ZXIoKGE6IHsgc3VjY2VzczogYm9vbGVhbiB9KSA9PiAhYS5zdWNjZXNzKS5sZW5ndGg7XG4gICAgaWYgKGZhaWxlZEF0dGVtcHRzID4gMCkge1xuICAgICAgcmlza1Njb3JlICs9IGZhaWxlZEF0dGVtcHRzICogMTA7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIGtub3duIHRydXN0ZWQgZGV2aWNlXG4gICAgY29uc3QgZGV2aWNlSWQgPSB0aGlzLmdlbmVyYXRlRGV2aWNlSWQoZmFjdG9ycy51c2VyQWdlbnQpO1xuICAgIGNvbnN0IHRydXN0ZWREZXZpY2UgPSBmYWN0b3JzLnVzZXJJZCA/IGF3YWl0IHByaXNtYS50cnVzdGVkRGV2aWNlLmZpbmRGaXJzdCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB1c2VySWQ6IGZhY3RvcnMudXNlcklkLFxuICAgICAgICBkZXZpY2VJZCxcbiAgICAgICAgaXNUcnVzdGVkOiB0cnVlLFxuICAgICAgICB0cnVzdEV4cGlyeTogeyBndDogbmV3IERhdGUoKSB9XG4gICAgICB9XG4gICAgfSkgOiBudWxsO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJpc2tTY29yZTogTWF0aC5taW4ocmlza1Njb3JlLCAxMDApLFxuICAgICAgcmVxdWlyZXMyRkE6IHJpc2tTY29yZSA+PSA1MCxcbiAgICAgIHJlcXVpcmVzVHJ1c3RlZERldmljZTogcmlza1Njb3JlID49IDcwICYmICF0cnVzdGVkRGV2aWNlXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyByZWNvcmRMb2dpbkF0dGVtcHQoZmFjdG9yczogUmlza0ZhY3RvcnMsIHN1Y2Nlc3M6IGJvb2xlYW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByaXNrU2NvcmUgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVJpc2tTY29yZShmYWN0b3JzKTtcbiAgICBjb25zdCBkZXZpY2VJZCA9IHRoaXMuZ2VuZXJhdGVEZXZpY2VJZChmYWN0b3JzLnVzZXJBZ2VudCk7XG4gICAgY29uc3QgZGV2aWNlVHlwZSA9IGdldERldmljZVR5cGUoZmFjdG9ycy51c2VyQWdlbnQpO1xuXG4gICAgYXdhaXQgcHJpc21hLmxvZ2luQXR0ZW1wdC5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICB1c2VySWQ6IGZhY3RvcnMudXNlcklkLFxuICAgICAgICBlbWFpbDogZmFjdG9ycy5lbWFpbCxcbiAgICAgICAgaXBBZGRyZXNzOiBmYWN0b3JzLmlwQWRkcmVzcyxcbiAgICAgICAgdXNlckFnZW50OiBmYWN0b3JzLnVzZXJBZ2VudCxcbiAgICAgICAgc3VjY2VzcyxcbiAgICAgICAgcmlza1Njb3JlLFxuICAgICAgICBkZXZpY2VUeXBlLFxuICAgICAgICBsb2NhdGlvbjogZmFjdG9ycy5sb2NhdGlvblxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHN1Y2Nlc3MgJiYgZmFjdG9ycy51c2VySWQpIHtcbiAgICAgIC8vIFVwZGF0ZSB1c2VyJ3MgcmlzayBzY29yZVxuICAgICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGZhY3RvcnMudXNlcklkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICByaXNrU2NvcmU6IHJpc2tTY29yZSxcbiAgICAgICAgICBsYXN0Umlza0Fzc2Vzc21lbnQ6IG5ldyBEYXRlKClcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIHRydXN0RGV2aWNlKHVzZXJJZDogc3RyaW5nLCB1c2VyQWdlbnQ6IHN0cmluZywgaXBBZGRyZXNzOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBkZXZpY2VJZCA9IHRoaXMuZ2VuZXJhdGVEZXZpY2VJZCh1c2VyQWdlbnQpO1xuICAgIGNvbnN0IHBhcnNlciA9IG5ldyBVQVBhcnNlcih1c2VyQWdlbnQpO1xuICAgIGNvbnN0IGRldmljZSA9IHBhcnNlci5nZXREZXZpY2UoKTtcbiAgICBjb25zdCBicm93c2VyID0gcGFyc2VyLmdldEJyb3dzZXIoKTtcbiAgICBjb25zdCBvcyA9IHBhcnNlci5nZXRPUygpO1xuXG4gICAgY29uc3QgZGV2aWNlTmFtZSA9IGAke2Jyb3dzZXIubmFtZSB8fCAnVW5rbm93bid9IG9uICR7b3MubmFtZSB8fCAnVW5rbm93bid9ICR7ZGV2aWNlLnR5cGUgPyBgKCR7ZGV2aWNlLnR5cGV9KWAgOiAnJ31gO1xuXG4gICAgYXdhaXQgcHJpc21hLnRydXN0ZWREZXZpY2UuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBkZXZpY2VJZCxcbiAgICAgICAgZGV2aWNlTmFtZSxcbiAgICAgICAgZGV2aWNlVHlwZTogZ2V0RGV2aWNlVHlwZSh1c2VyQWdlbnQpLFxuICAgICAgICBpcEFkZHJlc3MsXG4gICAgICAgIHVzZXJBZ2VudCxcbiAgICAgICAgaXNUcnVzdGVkOiB0cnVlLFxuICAgICAgICB0cnVzdEV4cGlyeTogbmV3IERhdGUoRGF0ZS5ub3coKSArIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCkgLy8gMzAgZGF5c1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVEZXZpY2VJZCh1c2VyQWdlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gR2VuZXJhdGUgYSB1bmlxdWUgZGV2aWNlIElEIGJhc2VkIG9uIHVzZXIgYWdlbnRcbiAgICAvLyBUaGlzIGlzIGEgc2ltcGxlIGltcGxlbWVudGF0aW9uIC0geW91IG1pZ2h0IHdhbnQgdG8gdXNlIGEgbW9yZSBzb3BoaXN0aWNhdGVkIG1ldGhvZFxuICAgIHJldHVybiBCdWZmZXIuZnJvbSh1c2VyQWdlbnQpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgfVxufSAiXSwibmFtZXMiOlsicHJpc21hIiwiVUFQYXJzZXIiLCJnZXREZXZpY2VUeXBlIiwidXNlckFnZW50IiwidGVzdCIsIlNlY3VyaXR5U2VydmljZSIsImNhbGN1bGF0ZVJpc2tTY29yZSIsImZhY3RvcnMiLCJzY29yZSIsInBhcnNlciIsImRldmljZSIsImdldERldmljZSIsImJyb3dzZXIiLCJnZXRCcm93c2VyIiwib3MiLCJnZXRPUyIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwidHlwZSIsInVuZGVmaW5lZCIsIk1hdGgiLCJtaW4iLCJhc3Nlc3NMb2dpblJpc2siLCJyaXNrU2NvcmUiLCJwcmV2aW91c0F0dGVtcHRzIiwibG9naW5BdHRlbXB0IiwiZmluZE1hbnkiLCJ3aGVyZSIsIk9SIiwiZW1haWwiLCJ1c2VySWQiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwidGFrZSIsImZhaWxlZEF0dGVtcHRzIiwiZmlsdGVyIiwiYSIsInN1Y2Nlc3MiLCJsZW5ndGgiLCJkZXZpY2VJZCIsImdlbmVyYXRlRGV2aWNlSWQiLCJ0cnVzdGVkRGV2aWNlIiwiZmluZEZpcnN0IiwiaXNUcnVzdGVkIiwidHJ1c3RFeHBpcnkiLCJndCIsIkRhdGUiLCJyZXF1aXJlczJGQSIsInJlcXVpcmVzVHJ1c3RlZERldmljZSIsInJlY29yZExvZ2luQXR0ZW1wdCIsImRldmljZVR5cGUiLCJjcmVhdGUiLCJkYXRhIiwiaXBBZGRyZXNzIiwibG9jYXRpb24iLCJ1c2VyIiwidXBkYXRlIiwiaWQiLCJsYXN0Umlza0Fzc2Vzc21lbnQiLCJ0cnVzdERldmljZSIsImRldmljZU5hbWUiLCJub3ciLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/security.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/openid-client","vendor-chunks/ua-parser-js","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/cookie","vendor-chunks/ms","vendor-chunks/oidc-token-hash","vendor-chunks/@panva","vendor-chunks/jsonwebtoken","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/safe-buffer","vendor-chunks/lodash.once","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isplainobject","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isinteger","vendor-chunks/lodash.isboolean","vendor-chunks/lodash.includes","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fsession%2Froute&page=%2Fapi%2Fauth%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fsession%2Froute.ts&appDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cecommerce-outset---amazon-seller-ecosystem%20(7)&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();